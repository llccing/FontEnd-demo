(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{240:function(e,t,r){"use strict";r.r(t);var s=r(0),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"core-js-3-babel展望未来"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#core-js-3-babel展望未来","aria-hidden":"true"}},[e._v("#")]),e._v(" core-js@3, babel展望未来")]),e._v(" "),r("p",[e._v("经过一年半的开发，数十个版本，许多不眠之夜，"),r("a",{attrs:{href:"https://github.com/zloirock/core-js",target:"_blank",rel:"noopener noreferrer"}},[e._v("core-js@3"),r("OutboundLink")],1),e._v("终于发布了。这是"),r("code",[e._v("core-js")]),e._v("和"),r("a",{attrs:{href:"https://babeljs.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("babel"),r("OutboundLink")],1),e._v(" \b补丁相关的功能的最大的一次变化。")]),e._v(" "),r("p",[e._v("什么是 "),r("code",[e._v("core-js")]),e._v("?")]),e._v(" "),r("ul",[r("li",[e._v("它是JavaScript标准库的补丁，它支持\n"),r("ul",[r("li",[e._v("最新的 "),r("a",{attrs:{href:"https://en.wikipedia.org/wiki/ECMAScript",target:"_blank",rel:"noopener noreferrer"}},[e._v("ECMAScript"),r("OutboundLink")],1),e._v(" 标准")]),e._v(" "),r("li",[e._v("ECMAScript 标准库提案")]),e._v(" "),r("li",[e._v("一些 "),r("a",{attrs:{href:"https://en.wikipedia.org/wiki/WHATWG",target:"_blank",rel:"noopener noreferrer"}},[e._v("WHATGW"),r("OutboundLink")],1),e._v("  / "),r("a",{attrs:{href:"https://en.wikipedia.org/wiki/World_Wide_Web_Consortium",target:"_blank",rel:"noopener noreferrer"}},[e._v("W3C"),r("OutboundLink")],1),e._v(" 标准（跨平台或者ECMAScript相关）")])])]),e._v(" "),r("li",[e._v("它最大限度的模块化：你能仅仅加载你想要使用的功能")]),e._v(" "),r("li",[e._v("它能够不污染全局命名空间")]),e._v(" "),r("li",[e._v("它"),r("a",{attrs:{href:"https://github.com/zloirock/core-js/blob/master/docs/2019-03-19-core-js-3-babel-and-a-look-into-the-future.md#Babel",target:"_blank",rel:"noopener noreferrer"}},[e._v("和babel紧密集成"),r("OutboundLink")],1),e._v("：这能够优化"),r("code",[e._v("core-js")]),e._v("的导入")])]),e._v(" "),r("p",[e._v("它是最普遍、"),r("a",{attrs:{href:"https://www.npmtrends.com/core-js-vs-es5-shim-vs-es6-shim-vs-airbnb-js-shims-vs-polyfill-library-vs-polyfill-service-vs-js-polyfills",target:"_blank",rel:"noopener noreferrer"}},[e._v("最流行"),r("OutboundLink")],1),e._v("的方式来给JavaScript标准库打补丁，但是有很大一部分开发者并不知道他们间接的使用了"),r("code",[e._v("core-js")]),e._v("🙂")]),e._v(" "),r("h2",{attrs:{id:"贡献"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#贡献","aria-hidden":"true"}},[e._v("#")]),e._v(" 贡献")]),e._v(" "),r("p",[r("code",[e._v("core-js")]),e._v("是我自己爱好的项目，没有给我带来任何利润。它花了我很长的时间，真的很昂贵：为了完成"),r("code",[e._v("core-js@3")]),e._v("，我在几个月之前已经离开我的工作。这个项目对许多人和公司起到了促进作用。因为这些，筹集资金去支持"),r("code",[e._v("core-js")]),e._v("的维护是说得通的。")]),e._v(" "),r("p",[e._v("如果你对"),r("code",[e._v("core-js")]),e._v("感兴趣或者在你每天的工作中有使用到，你可以在"),r("a",{attrs:{href:"https://opencollective.com/core-js#sponsor",target:"_blank",rel:"noopener noreferrer"}},[e._v("Open Collective"),r("OutboundLink")],1),e._v("和"),r("a",{attrs:{href:"https://www.patreon.com/zloirock",target:"_blank",rel:"noopener noreferrer"}},[e._v("Patreon"),r("OutboundLink")],1),e._v("成为赞助者。")]),e._v(" "),r("p",[e._v("你可以给"),r("a",{attrs:{href:"http://zloirock.ru/",target:"_blank",rel:"noopener noreferrer"}},[e._v("我"),r("OutboundLink")],1),e._v("提供一个好的工作，和我现在做的相关的。")]),e._v(" "),r("p",[e._v("或者你可以以另一种方式贡献，你可以帮助去改进代码，测试或者文档（现在，"),r("code",[e._v("core-js")]),e._v("的文档还很糟糕！）。")]),e._v(" "),r("h2",{attrs:{id:"core-js-3有哪些变化？"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#core-js-3有哪些变化？","aria-hidden":"true"}},[e._v("#")]),e._v(" "),r("code",[e._v("core-js@3")]),e._v("有哪些变化？")]),e._v(" "),r("h3",{attrs:{id:"javascript标准库中变化的内容"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#javascript标准库中变化的内容","aria-hidden":"true"}},[e._v("#")]),e._v(" JavaScript标准库中变化的内容")]),e._v(" "),r("p",[e._v("由于以下两个原因，这个版本包含丰富的 新的JavaScript补丁：")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("core-js")]),e._v(" 只在 major（主）版本更新时才有 break changes，即使需要和提案的内容对齐。")]),e._v(" "),r("li",[r("code",[e._v("core-js@2")]),e._v(" 在一年半前已经进入功能冻结阶段了；所有新的功能只能够添加到"),r("code",[e._v("core-js@3")]),e._v("这个分支。")])]),e._v(" "),r("h4",{attrs:{id:"稳定的ecmascript功能"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#稳定的ecmascript功能","aria-hidden":"true"}},[e._v("#")]),e._v(" 稳定的ECMAScript功能")]),e._v(" "),r("p",[e._v("稳定的ECMAScript功能在"),r("code",[e._v("core-js")]),e._v("中已经几乎完全支持有很长一段时间了，除此之外，"),r("code",[e._v("core-js@3")]),e._v("引进了一些新功能：")]),e._v(" "),r("ul",[r("li",[e._v("增加支持 ECMAScript 2015引入的两个知名标志 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/isConcatSpreadable",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("@@isConcatSpreadable")]),r("OutboundLink")],1),e._v("和"),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/species",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("@@species")]),r("OutboundLink")],1),e._v("，给所有使用他们的方法。")]),e._v(" "),r("li",[e._v("增加来自ECMAScript 2018的 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flat",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Array.prototype.flat")]),r("OutboundLink")],1),e._v("和"),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Array.prototype.flatMap")]),r("OutboundLink")],1),e._v("（"),r("code",[e._v("core-js@2")]),e._v("针对"),r("code",[e._v("Array.prototype.flatten")]),e._v("这个老版本的提案提供了补丁）。")]),e._v(" "),r("li",[e._v("增加来自ECMAScript 2019的"),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Object.fromEntries")]),r("OutboundLink")],1),e._v("方法")]),e._v(" "),r("li",[e._v("增加来自ECMAScript 2019的 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/description",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Symbol.prototype.description")]),r("OutboundLink")],1),e._v("访问器")])]),e._v(" "),r("p",[e._v("一些在ES2016-ES2019中作为提案被接受且已经使用很长时间的功能，现在被标记为稳定：")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Array.prototype.includes")]),r("OutboundLink")],1),e._v(" 和 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray/includes",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("TypedArray.prototype.includes")]),r("OutboundLink")],1),e._v(" 方法（ESMAScript 2016）")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/values",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Object.values")]),r("OutboundLink")],1),e._v(" 和 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Object.entries")]),r("OutboundLink")],1),e._v(" 方法(ECMAScript 2017)")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptors",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Object.getOwnPropertyDescriptors")]),r("OutboundLink")],1),e._v(" 方法 (ECMAScript 2017)")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/padStart",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("String.prototype.padStart")]),r("OutboundLink")],1),e._v(" 和 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/padEnd",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("String.prototype.padEnd")]),r("OutboundLink")],1),e._v(" 方法（ECMAScript 2017）")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/finally",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Promise.prototype.finally")]),r("OutboundLink")],1),e._v(" 方法（ECMAScript 2018）")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/asyncIterator",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Symbol.asyncIterator")]),r("OutboundLink")],1),e._v(" 知名标志（ECMAScript 2018）")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineGetter__",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Object.prototype.__define(Getter|Setter)__")]),r("OutboundLink")],1),e._v(" 和 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/__lookupGetter__",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Object.prototype.__lookup(Getter|Setter)__")]),r("OutboundLink")],1),e._v(" 方法（ECMAScript 2018）")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/trimStart",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("String.prototype.trim(Start|End|Left|Right)")]),r("OutboundLink")],1),e._v(" 方法（ECMAScript 2019）")])]),e._v(" "),r("p",[e._v("修复了针对浏览器的许多问题，例如, "),r("a",{attrs:{href:"https://bugs.webkit.org/show_bug.cgi?id=188794",target:"_blank",rel:"noopener noreferrer"}},[e._v("Safari 12.0 "),r("code",[e._v("Array.prototype.reverse")]),e._v(" bug"),r("OutboundLink")],1),e._v(" 已经被修复了。")]),e._v(" "),r("h4",{attrs:{id:"ecmascript-提案"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#ecmascript-提案","aria-hidden":"true"}},[e._v("#")]),e._v(" ECMAScript 提案")]),e._v(" "),r("p",[e._v("除了上文提到的支持内容，"),r("code",[e._v("core-js@3")]),e._v("现在还支持下面的 ECMAScript 提案：")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-global",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("globalThis")]),r("OutboundLink")],1),e._v(" stage 3（现在是 stage 4）的提案 - 之前，已经有了 "),r("code",[e._v("global")]),e._v(" 和 "),r("code",[e._v("System.global")])]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-promise-allSettled",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Promise.allSettled")]),r("OutboundLink")],1),e._v(" stage 2（现在是 stage 4）提案")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-set-methods",target:"_blank",rel:"noopener noreferrer"}},[e._v("新 "),r("code",[e._v("Set")]),e._v(" 方法"),r("OutboundLink")],1),e._v(" stage 2 提案：\n"),r("ul",[r("li",[e._v("Set.prototype.difference")]),e._v(" "),r("li",[e._v("Set.prototype.intersection")]),e._v(" "),r("li",[e._v("Set.prototype.isDisjoinFrom")]),e._v(" "),r("li",[e._v("Set.prototype.isSubsetOf")]),e._v(" "),r("li",[e._v("Set.prototype.isSupersetOf")]),e._v(" "),r("li",[e._v("Set.prototype.symmetricDifference")]),e._v(" "),r("li",[e._v("Set.prototype.union")])])]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-collection-methods",target:"_blank",rel:"noopener noreferrer"}},[e._v("新 collections 方法"),r("OutboundLink")],1),e._v(" stage 1 提案，包函许多新的有用的方法：\n"),r("ul",[r("li",[e._v("Map.groupBy")]),e._v(" "),r("li",[e._v("Map.keyBy")]),e._v(" "),r("li",[e._v("Map.prototype.deleteAll")]),e._v(" "),r("li",[e._v("Map.prototype.every")]),e._v(" "),r("li",[e._v("Map.prototype.filter")]),e._v(" "),r("li",[e._v("Map.prototype.find")]),e._v(" "),r("li",[e._v("Map.prototype.findKey")]),e._v(" "),r("li",[e._v("Map.prototype.includes")]),e._v(" "),r("li",[e._v("Map.prototype.keyOf")]),e._v(" "),r("li",[e._v("Map.prototype.mapKeys")]),e._v(" "),r("li",[e._v("Map.prototype.mapValues")]),e._v(" "),r("li",[e._v("Map.prototype.merge")]),e._v(" "),r("li",[e._v("Map.prototype.reduce")]),e._v(" "),r("li",[e._v("Map.prototype.some")]),e._v(" "),r("li",[e._v("Map.prototype.update")]),e._v(" "),r("li",[e._v("Set.prototype.addAll")]),e._v(" "),r("li",[e._v("Set.prototype.deleteAll")]),e._v(" "),r("li",[e._v("Set.prototype.every")]),e._v(" "),r("li",[e._v("Set.prototype.filter")]),e._v(" "),r("li",[e._v("Set.prototype.find")]),e._v(" "),r("li",[e._v("Set.prototype.join")]),e._v(" "),r("li",[e._v("Set.prototype.map")]),e._v(" "),r("li",[e._v("Set.prototype.reduce")]),e._v(" "),r("li",[e._v("Set.prototype.some")]),e._v(" "),r("li",[e._v("WeakMap.prototype.deleteAll")]),e._v(" "),r("li",[e._v("WeakSet.prototype.addAll")]),e._v(" "),r("li",[e._v("WeakSet.prototype.deleteAll")])])]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-string-replace-all",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("String.prototype.replaceAll")]),r("OutboundLink")],1),e._v(" stage 1（现在是 stage 3） 提案")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-string-prototype-codepoints",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("String.prototype.codePoints")]),r("OutboundLink")],1),e._v(" stage 1 提案")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/tc39-transfer/proposal-array-last",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Array.prototype.last(Item|Index)")]),r("OutboundLink")],1),e._v(" stage 1 提案")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/bmeck/proposal-richer-keys/tree/master/compositeKey",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("compositeKey")]),e._v(" 和 "),r("code",[e._v("compositeSymbol")]),e._v(" 方法"),r("OutboundLink")],1),e._v(" stage 1 提案")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-number-fromstring",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Number.fromString")]),r("OutboundLink")],1),e._v(" stage 1 提案")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-seeded-random",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Math.seededPRNG")]),r("OutboundLink")],1),e._v(" stage 1 提案")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-promise-any",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Promise.any")]),e._v(" (合并的错误)"),r("OutboundLink")],1),e._v(" stage 0（现在是stage 3）提案")])]),e._v(" "),r("p",[e._v("一些提案的变化很大，"),r("code",[e._v("core-js")]),e._v(" 也将相应的更新：")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-string-matchall",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("String.prototype.matchAll")]),r("OutboundLink")],1),e._v(" stage 3 提案")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/tc39/proposal-observable",target:"_blank",rel:"noopener noreferrer"}},[e._v("Observable"),r("OutboundLink")],1),e._v(" stage 1 提案")])]),e._v(" "),r("h4",{attrs:{id:"web-标准"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#web-标准","aria-hidden":"true"}},[e._v("#")]),e._v(" web 标准")]),e._v(" "),r("p",[e._v("许多有用的功能被添加到这个类别中。")]),e._v(" "),r("p",[e._v("最重要的一个是 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/URL",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("URL")]),r("OutboundLink")],1),e._v(" 和 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("URLSearchParams")]),r("OutboundLink")],1),e._v("。他是"),r("a",{attrs:{href:"https://github.com/zloirock/core-js/issues/117",target:"_blank",rel:"noopener noreferrer"}},[e._v("最受欢迎的功能请求之一"),r("OutboundLink")],1),e._v("。增加 "),r("code",[e._v("URL")]),e._v(" 和 "),r("code",[e._v("URLSearchParams")]),e._v("，并保证他们最大限度的符合规范，保持源代码足够紧凑来支撑任何环境是"),r("code",[e._v("core-js@3")]),e._v("开发中"),r("a",{attrs:{href:"https://github.com/zloirock/core-js/pull/454/files",target:"_blank",rel:"noopener noreferrer"}},[e._v("最困难的任务之一"),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("p",[r("code",[e._v("core-js@3")]),e._v("包函在JavaScript中创建微任务（microtask）的标准方法："),r("a",{attrs:{href:"https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#microtask-queuing",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("queueMicrotask")]),r("OutboundLink")],1),e._v("。"),r("code",[e._v("core-js@2")]),e._v("提供了 "),r("code",[e._v("asap")]),e._v("函数，提供了同样功能的老的提案。"),r("code",[e._v("queueMicrotask")]),e._v(" 被定义在 HTML 标准中，它已经能够在现代浏览器比如 Chromium 或者 NodeJS 中使用。")]),e._v(" "),r("p",[e._v("另一个受欢迎的功能请求是支持 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/NodeList/forEach",target:"_blank",rel:"noopener noreferrer"}},[e._v("DOM集合的 "),r("code",[e._v(".forEach")]),e._v(" 方法"),r("OutboundLink")],1),e._v("。由于 "),r("code",[e._v("core-js")]),e._v(" 已经针对DOM集合迭代器做了polyfill，为什么给 "),r("code",[e._v("节点列表")]),e._v(" 和 "),r("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/DOMTokenList",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("DOMTokenList")]),r("OutboundLink")],1),e._v(" 也增加 "),r("code",[e._v(".forEach")]),e._v(" 呢？")]),e._v(" "),r("h4",{attrs:{id:"移除过时的功能："}},[r("a",{staticClass:"header-anchor",attrs:{href:"#移除过时的功能：","aria-hidden":"true"}},[e._v("#")]),e._v(" 移除过时的功能：")]),e._v(" "),r("ul",[r("li",[r("code",[e._v("Reflect.enumrate")]),e._v(" 因为他已经从标准中移除了")]),e._v(" "),r("li",[r("code",[e._v("System.global")]),e._v(" 和 "),r("code",[e._v("global")]),e._v(" 现在他们已经被 "),r("code",[e._v("globalThis")]),e._v(" 代替")]),e._v(" "),r("li",[r("code",[e._v("Array.prototype.flatten")]),e._v(" 现在被 "),r("code",[e._v("Array.prototype.flat")]),e._v(" 代替")]),e._v(" "),r("li",[r("code",[e._v("asap")]),e._v(" 被 "),r("code",[e._v("queueMicrotask")]),e._v(" 代替")]),e._v(" "),r("li",[r("code",[e._v("Error.isError")]),e._v(" 被撤销很长时间了")]),e._v(" "),r("li",[r("code",[e._v("RegExp.escape")]),e._v(" 很久之前被拒绝了")]),e._v(" "),r("li",[r("code",[e._v("Map.prototype.toJSON")]),e._v(" 和 "),r("code",[e._v("Set.prototype.toJSON")]),e._v(" 也是很久前被拒绝了")]),e._v(" "),r("li",[e._v("不必要并且被错误添加的迭代器方法："),r("code",[e._v("CSSRuleList")]),e._v("，"),r("code",[e._v("MediaList")]),e._v("，"),r("code",[e._v("StyleSheetList")]),e._v("。")])]),e._v(" "),r("h4",{attrs:{id:"不再有非标准、非提案的功能"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#不再有非标准、非提案的功能","aria-hidden":"true"}},[e._v("#")]),e._v(" 不再有非标准、非提案的功能")]),e._v(" "),r("p",[e._v("许多年前，我开始写一个库，他是我的JavaScript程序的核心：这个库包函polyfills和一些我需要的工具函数。一段时间后，这个库以 "),r("code",[e._v("core-js")]),e._v(" 命名发布。我认为现在大多数 "),r("code",[e._v("core-js")]),e._v(" 用户不需要非标准的 "),r("code",[e._v("core-js")]),e._v(" 功能，他们大多已经在早期版本移除了，现在是时候将剩余部分从 "),r("code",[e._v("core-js")]),e._v(" 中移除。从这个版本开始，"),r("code",[e._v("core-js")]),e._v(" 可以被称为 polyfill了。")]),e._v(" "),r("h3",{attrs:{id:"包、入口和模块名字"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#包、入口和模块名字","aria-hidden":"true"}},[e._v("#")]),e._v(" 包、入口和模块名字")]),e._v(" "),r("p",[e._v("一个issue里提了 "),r("code",[e._v("core-js")]),e._v(" 包的很大（~2MB），有很多重复文件。因为这个原因，"),r("code",[e._v("core-js")]),e._v(" 分成了3个包：")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.npmjs.com/package/core-js",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("core-js")]),r("OutboundLink")],1),e._v(" 定义全局的polyfills。（~500KB，"),r("a",{attrs:{href:"https://bundlephobia.com/result?p=core-js@3.0.0-beta.20",target:"_blank",rel:"noopener noreferrer"}},[e._v("压缩并且gzipped处理后 40KB"),r("OutboundLink")],1),e._v("）")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://www.npmjs.com/package/core-js-pure",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("core-js-pure")]),r("OutboundLink")],1),e._v("，提供了不污染全局变量的polyfills。它和 "),r("code",[e._v("core-js@2")]),e._v("中的 "),r("code",[e._v("core-js/library")]),e._v(" 相当。（~440KB）")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://www.npmjs.com/package/core-js-bundle",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("core-js-bundle")]),r("OutboundLink")],1),e._v("：定义了全局填充的打包版本")])]),e._v(" "),r("p",[r("code",[e._v("core-js")]),e._v(" 的早期版本中，稳定的ECMAScript功能和 ECMAScript提案的polyfill模块化需要分别加 "),r("code",[e._v("es6.")]),e._v(" 和 "),r("code",[e._v("es7.")]),e._v(" 前缀。这是在2014年做的决定，那时将 ES6 之后的所有功能都视为 ES7。在 "),r("code",[e._v("core-js@3")]),e._v(" 中所有稳定的 ECMAScript 功能都增加 "),r("code",[e._v("es.")]),e._v(" 前缀，ECMAScript 提案增加 "),r("code",[e._v("esnext.")]),e._v(" 前缀。")]),e._v(" "),r("p",[e._v("几乎所有的 CommonJS 入口都改变了。"),r("code",[e._v("core-js@3")]),e._v(" 相比于 "),r("code",[e._v("core-js@2")]),e._v(" 有更多的入口：这带来的最大限度的灵活性，使你能够仅仅引入你的应用需要的依赖。")]),e._v(" "),r("p",[e._v("这里是一些例子关于如何使用新的入口：")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 使用 `core-js`全部功能打补丁：")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 仅仅使用稳定的`core-js`功能 - ES 和 web标准：")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/stable"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 仅仅使用稳定的 ES 功能")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/es"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 如果你想用`Set`的补丁")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 所有 `Set`- ES 提案中，相关的功能：")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/features/set"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 稳定的 `Set` ES 功能和来自web标准的功能")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// （DOM 集合迭代器）")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/stable/set"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 只有 `Set`所需的稳定的 ES 功能")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/es/set"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 与上面一致，但不会污染全局命名空间")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" Set "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js-pure/features/set"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" Set "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js-pure/stable/set"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" Set "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js-pure/es/set"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 仅仅为需要的方法打补丁")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/feature/set/intersection"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/stable/queque-microtask"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/es/array/from"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 为 reflect metadata 提案打补丁")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/proposals/reflect-metadata"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 为所有 stage 2+ 的提案打补丁")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/stage/2"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("h3",{attrs:{id:"其他重要的变化"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#其他重要的变化","aria-hidden":"true"}},[e._v("#")]),e._v(" 其他重要的变化")]),e._v(" "),r("p",[r("code",[e._v("core-js")]),e._v(" polyfill 能够 "),r("a",{attrs:{href:"https://github.com/zloirock/core-js/blob/master/README.md#configurable-level-of-aggressiveness",target:"_blank",rel:"noopener noreferrer"}},[e._v("配置入侵等级"),r("OutboundLink")],1),e._v("。如果你认为有些情境 "),r("code",[e._v("core-js")]),e._v(" 功能检测侵入性太强，原生实现对你来说已经足够，或者一个错误的实现没有被 "),r("code",[e._v("core-js")]),e._v(" 检测到，你可以修改 "),r("code",[e._v("core-js")]),e._v(" 的默认行为。")]),e._v(" "),r("p",[e._v("如果无法安装规范的每个细节实现某个功能，"),r("code",[e._v("core-js")]),e._v(" 增加了一个 "),r("code",[e._v(".sham")]),e._v(" 属性，例如，IE11中 "),r("code",[e._v("Symbol.sham")]),e._v(" 是 "),r("code",[e._v("true")]),e._v("。")]),e._v(" "),r("p",[e._v("不再有 LiveScript! 当我开始写 "),r("code",[e._v("core-js")]),e._v(" 时，我主要使用的是 "),r("a",{attrs:{href:"http://livescript.net/",target:"_blank",rel:"noopener noreferrer"}},[e._v("LiveScript"),r("OutboundLink")],1),e._v("；一段时间后，我用JavaScript重写了全部的polyfills。在 "),r("code",[e._v("core-js@2")]),e._v(" 中测试和帮助的工具函数仍然使用 LiveScript：它是非常有趣的像CoffeeScript一样的语言，有强大的语法糖使你能够写非常紧凑的代码，但是它几乎已经死了。除此之外，它也是为 "),r("code",[e._v("core-js")]),e._v(" 贡献的屏障，因为大多数 "),r("code",[e._v("core-js")]),e._v(" 用户不知道这个语言。"),r("code",[e._v("core-js@3")]),e._v("测试和工具函数使用现代 ES 语法：它将成为为 "),r("code",[e._v("core-js")]),e._v(" 贡献的好时机🙂。")]),e._v(" "),r("p",[e._v("对于大多数用户，为了优化 "),r("code",[e._v("core-js")]),e._v(" 导入，我建议使用 "),r("a",{attrs:{href:"#Babel"}},[e._v("babel")]),e._v("。当然，有些情况下 "),r("a",{attrs:{href:"http://npmjs.com/package/core-js-builder",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("core-js-builder")]),r("OutboundLink")],1),e._v(" 仍然有用。现在它支持 "),r("code",[e._v("target")]),e._v(" 参数，使用带有目标引擎的"),r("a",{attrs:{href:"https://github.com/browserslist/browserslist",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("浏览器列表")]),r("OutboundLink")],1),e._v(" 查询 - 你能够创建一个bundle，仅仅包含目标引擎需要的polyfills。对于这种情况，我做了 "),r("a",{attrs:{href:"https://www.npmjs.com/package/core-js-compat",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("core-js-compat")]),r("OutboundLink")],1),e._v("，更多关于它的信息，你能够从 "),r("a",{attrs:{href:"#babelpreset-env"}},[e._v("这篇文章的 "),r("code",[e._v("@babel/preset-env")]),e._v(" 部分")]),e._v("了解到。")]),e._v(" "),r("hr"),e._v(" "),r("p",[e._v("这仅仅是冰山一角，更多的变化在内部。更多关于 "),r("code",[e._v("core-js")]),e._v(" 变化可以在 "),r("a",{attrs:{href:"https://github.com/zloirock/core-js/blob/master/CHANGELOG.md#300",target:"_blank",rel:"noopener noreferrer"}},[e._v("changelog"),r("OutboundLink")],1),e._v(" 中找到。")]),e._v(" "),r("h2",{attrs:{id:"babel"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#babel","aria-hidden":"true"}},[e._v("#")]),e._v(" Babel")]),e._v(" "),r("p",[e._v("正如上文提到的，"),r("code",[e._v("babel")]),e._v(" 和 "),r("code",[e._v("core-js")]),e._v(" 是紧密集成的："),r("code",[e._v("babel")]),e._v(" 提供了优化 "),r("code",[e._v("core-js")]),e._v(" 优化导入的可能性。"),r("code",[e._v("core-js@3")]),e._v(" 开发中很重要的一部分是改进"),r("code",[e._v("core-js")]),e._v("相关的 "),r("code",[e._v("babel")]),e._v(" 功能（看"),r("a",{attrs:{href:"https://github.com/babel/babel/pull/7646",target:"_blank",rel:"noopener noreferrer"}},[e._v("这个PR"),r("OutboundLink")],1),e._v("）。这些变化在 "),r("a",{attrs:{href:"https://babeljs.io/blog/2019/03/19/7.4.0",target:"_blank",rel:"noopener noreferrer"}},[e._v("Babel 7.4.0"),r("OutboundLink")],1),e._v(" 发布了。")]),e._v(" "),r("h3",{attrs:{id:"babel-polyfill"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#babel-polyfill","aria-hidden":"true"}},[e._v("#")]),e._v(" babel/polyfill")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://babeljs.io/docs/en/next/babel-polyfill.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("@babel/polyfill")]),r("OutboundLink")],1),e._v(" 是一个包裹的包，里面仅仅包含 "),r("code",[e._v("core-js")]),e._v(" 稳定版的引入（在Babel 6 中也包含提案）和 "),r("code",[e._v("regenerator-runtime/runtime")]),e._v("，用来转译generators和async函数。这个包没有提供从 "),r("code",[e._v("core-js@2")]),e._v(" 到 "),r("code",[e._v("core-js@3")]),e._v(" 平滑升级路径：因为这个原因，决定弃用 "),r("code",[e._v("@babel/polyfill")]),e._v(" 代之以分别引入需要的"),r("code",[e._v("core-js")]),e._v(" 和 "),r("code",[e._v("regenerator-runtime")]),e._v("。")]),e._v(" "),r("p",[e._v("原来")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"@babel/polyfill"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("现在使用两行：")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/stable"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"regenerator-runtime/runtime"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("别忘记直接安装这两个依赖！")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[e._v("npm i "),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("--")]),e._v("save core"),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("js regenerator"),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("runtime\n")])])]),r("h3",{attrs:{id:"babe-preset-env"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#babe-preset-env","aria-hidden":"true"}},[e._v("#")]),e._v(" @babe/preset-env")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://babeljs.io/docs/en/next/babel-preset-env#usebuiltins",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("@babel/preset-env")]),r("OutboundLink")],1),e._v(" 有两种不同的模式，通过 "),r("code",[e._v("useBuiltIns")]),e._v(" 选项："),r("code",[e._v("entry")]),e._v(" 和 "),r("code",[e._v("usage")]),e._v(" 优化 "),r("code",[e._v("core-js")]),e._v("的导入。")]),e._v(" "),r("p",[e._v("Babel 7.4.0 引入了两种模式的共同更改，以及每种模式的特定的修改。")]),e._v(" "),r("p",[e._v("由于现在 "),r("code",[e._v("@babel/preset-env")]),e._v(" 支持 "),r("code",[e._v("core-js@2")]),e._v(" 和 "),r("code",[e._v("core-js@3")]),e._v("，因此 "),r("code",[e._v("useBuiltIns")]),e._v(" 需要新的选项 -- "),r("code",[e._v("corejs")]),e._v("，这个选项用来定义使用 "),r("code",[e._v("core-js")]),e._v(" 的版本（"),r("code",[e._v("corejs: 2")]),e._v(" or "),r("code",[e._v("corejs: 3")]),e._v("）。如果没有设置，"),r("code",[e._v("corejs: 2")]),e._v(" 是默认值并且会有警告提示。")]),e._v(" "),r("p",[e._v("为了使 babel 支持将来的次要版本中引入的 "),r("code",[e._v("core-js")]),e._v(" 的新功能，你可以在项目中定义明确的次要版本号。例如，你想使用 "),r("code",[e._v("core-js@3.1")]),e._v(" 使用这个版本的新特性，你可以设置 "),r("code",[e._v("corejs")]),e._v(" 选项为 "),r("code",[e._v("3.1")]),e._v("："),r("code",[e._v("corejs: '3.1'")]),e._v(" 或者 "),r("code",[e._v("corejs: {version: '3.1'}")]),e._v("。")]),e._v(" "),r("p",[r("code",[e._v("@babel/preset-env")]),e._v(" 最重要的一个功能就是提供不同浏览器支持特性的数据来源，用来确定是否需要 "),r("code",[e._v("core-js")]),e._v(" 填充某些内容。 "),r("a",{attrs:{href:"https://caniuse.com/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("caniuse")]),r("OutboundLink")],1),e._v("，"),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("mdn")]),r("OutboundLink")],1),e._v(" 和 "),r("a",{attrs:{href:"http://kangax.github.io/compat-table/es6/",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("compat-table")]),r("OutboundLink")],1),e._v(" 是很好的教育资源，但是并不意味着他们能够作为数据源被开发者使用：只有 "),r("code",[e._v("compat-table")]),e._v(" 包函好的 ES 相关数据集，它被 "),r("code",[e._v("@babel/preset-env")]),e._v(" 使用，但是仍有些限制：")]),e._v(" "),r("ul",[r("li",[r("p",[e._v("它包含的数据仅仅关于 ECMAScript 特性和提案，和 web 平台特性例如 "),r("code",[e._v("setImmediate")]),e._v(" 或者 DOM 集合迭代器没有关系。所以直到现在，"),r("code",[e._v("@babel/preset-env")]),e._v("仍然通过 "),r("code",[e._v("core-js")]),e._v(" 添加全部的 web 平台特性即使他们已经支持了。")])]),e._v(" "),r("li",[r("p",[e._v("它他不包含任何浏览器（甚至是严重的）bug信息：例如，上文提到的在Safari 12中 "),r("code",[e._v("Array#reverse")]),e._v("，但是 "),r("code",[e._v("compat-table")]),e._v(" 并没有将它标记为不支持。另一方面，"),r("code",[e._v("core-js")]),e._v(" 已经修复了这个错误实现，但是因为 "),r("code",[e._v("compat-table")]),e._v(" 关系，并不能使用它。")])]),e._v(" "),r("li",[r("p",[e._v("它仅包函一些基础的、幼稚的测试，没有检查功能在真实环境下是否可以正常工作。例如，老版本Safari的破坏的迭代器没有 "),r("code",[e._v(".next")]),e._v(" 方法，但是 "),r("code",[e._v("compat-table")]),e._v(" 表明Safari支持，因为它用 "),r("code",[e._v("typeof")]),e._v(" 方法检测迭代器方法返回了 "),r("code",[e._v('"function"')]),e._v("。一些像 typed arrays 的功能几乎没有覆盖。")])]),e._v(" "),r("li",[r("p",[r("code",[e._v("compat-table")]),e._v(" 不是为了向工具提供数据而设计的。我是 "),r("code",[e._v("compat-table")]),e._v(" 的维护者之一，但是"),r("a",{attrs:{href:"https://github.com/kangax/compat-table/pull/1312",target:"_blank",rel:"noopener noreferrer"}},[e._v("其他的维护者反对为维护这个功能"),r("OutboundLink")],1),e._v("。")])])]),e._v(" "),r("p",[e._v("因为这个原因，我创建了 "),r("a",{attrs:{href:"https://github.com/zloirock/core-js/tree/master/packages/core-js-compat",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("core-js-compat")]),r("OutboundLink")],1),e._v("：它提供了对于不同浏览器 "),r("code",[e._v("core-js")]),e._v(" 模块的必要性数据。当使用 "),r("code",[e._v("core-js@3")]),e._v(" 时，"),r("code",[e._v("@babel/preset-env")]),e._v(" 将使用新的包取代 "),r("code",[e._v("compat-table")]),e._v("。"),r("a",{attrs:{href:"https://github.com/zloirock/core-js/blob/master/CONTRIBUTING.md#updating-core-js-compat-data",target:"_blank",rel:"noopener noreferrer"}},[e._v("请帮助我们测试并提供缺少的引擎的数据的映射关系！"),r("OutboundLink")],1),e._v("😊。")]),e._v(" "),r("p",[e._v("在 Babel 7.3 之前，"),r("code",[e._v("@babel/preset-env")]),e._v(" 有一些与polyfills注入顺序有关的问题。从 7.4.0开始，"),r("code",[e._v("@babel/preset-env")]),e._v(" 只按推荐顺序增加需要的polyfills。")]),e._v(" "),r("h4",{attrs:{id:"usebuiltins-entry-with-corejs-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#usebuiltins-entry-with-corejs-3","aria-hidden":"true"}},[e._v("#")]),e._v(" "),r("code",[e._v("useBuiltIns: entry")]),e._v(" with "),r("code",[e._v("corejs: 3")])]),e._v(" "),r("p",[e._v("当使用这个选项时，"),r("code",[e._v("@babel/preset-env")]),e._v(" 代替直接引用 "),r("code",[e._v("core-js")]),e._v(" 而是引入目标环境特定需要的模块。")]),e._v(" "),r("p",[e._v("在这个变化前，"),r("code",[e._v("@babel/preset")]),e._v(" 仅替换 "),r("code",[e._v("import '@babel/polyfill'")]),e._v(" 和 "),r("code",[e._v("import 'core-js'")]),e._v("，他们是同义词用来polyfill所有稳定的 JavaScript 特性。")]),e._v(" "),r("p",[e._v("现在 "),r("code",[e._v("@babel/polyfill")]),e._v(" 弃用了，当 "),r("code",[e._v("corejs")]),e._v(" 设置为 3 时 "),r("code",[e._v("@babel/preset-env")]),e._v(" 不会转译他。")]),e._v(" "),r("p",[r("code",[e._v("core-js@3")]),e._v(" 中等价替换 "),r("code",[e._v("@babel/polyfill")]),e._v("是")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/stable"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"regenerator-runtime/runtime"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("当目标浏览器是 "),r("code",[e._v("chrome 72")]),e._v(" 时，上面的内容将被 "),r("code",[e._v("@babel/preset-env")]),e._v(" 转换为")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/es.array.unscopables.flat"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/es.array.unscopaables.flat-map"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/es.object.from-entries"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modlues/web.immediate"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("当目标浏览器是 "),r("code",[e._v("chrome 73")]),e._v("（它完全支持 ES2019 标准库），他将变为很少的引入：")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/web.immediate"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("自从 "),r("code",[e._v("@babel/polyfill")]),e._v(" 被弃用，转而使用分开的 "),r("code",[e._v("core-js")]),e._v(" 和 "),r("code",[e._v("regenerator-runtime")]),e._v("，我们能够优化 "),r("code",[e._v("regenerator-runtime")]),e._v(" 的导入。因为这个原因，如果目标浏览器原生支持 generators ，那么 "),r("code",[e._v("regenerator-runtime")]),e._v(" 的导入将从源代码中移除。")]),e._v(" "),r("p",[e._v("现在，设置 "),r("code",[e._v("useBuiltIns: entry")]),e._v(" 模式的 "),r("code",[e._v("@babel/preset-env")]),e._v(" 编译所有能够获得的 "),r("code",[e._v("core-js")]),e._v(" 入口和他们的组合。这意味着你能够自定义，通过使用不同的 "),r("code",[e._v("core-js")]),e._v(" 入口，它将根据的目标环境优化。")]),e._v(" "),r("p",[e._v("例如，目标环境是 "),r("code",[e._v("chrome 72")]),e._v("，")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/es"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/proposals/set-methods"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/features/set/map"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("将被替换为")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/es.array.unscopables.flat"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/es.array.unscopables.flat-map"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/es.object.from-entries"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/esnext.set.difference"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/esnext.set.intersection"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/esnext.set.is-disjoint-from"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/esnext.set.is-subset-of"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/esnext.set.is-superset-of"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/esnext.set.map"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/esnext.set.symmetric-difference"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/esnext.set.union"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("h4",{attrs:{id:"usebuiltins-usage-with-corejs-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#usebuiltins-usage-with-corejs-3","aria-hidden":"true"}},[e._v("#")]),e._v(" "),r("code",[e._v("useBuiltIns: usage")]),e._v(" with "),r("code",[e._v("corejs: 3")])]),e._v(" "),r("p",[e._v("当使用这个选项时，"),r("code",[e._v("@babel/preset-env")]),e._v(" 在每个每个文件的开头引入目标环境不支持，仅在当前文件中使用的polyfills。")]),e._v(" "),r("p",[e._v("例如，")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("set")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("new")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Set")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("includes")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("当目标环境是老的浏览器例如 "),r("code",[e._v("ie 11")]),e._v("，将转换为")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/es.array.includes"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/es.array.iterator"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/es.object.to-string"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"core-js/modules/es.set"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("set")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("new")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Set")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("includes")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("当目标是 "),r("code",[e._v("chrome 72")]),e._v("时不需要导入，因为这个环境需要polyfills：")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("set")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("new")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Set")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("includes")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("Babel 7.3 之前，"),r("code",[e._v("useBuiltIns: usage")]),e._v(" 不稳定且不是足够可靠：许多 polyfills 不包函，并且添加了许多不是必须依赖的 polyfills。在 Babel 7.4 中，我尝试使它理解每种可能的使用模式。")]),e._v(" "),r("p",[e._v("在属性访问器、对象解构、"),r("code",[e._v("in")]),e._v(" 操作符、全局对象属性访问方面，我改进了确定使用哪个 polyfills 的技术。")]),e._v(" "),r("p",[r("code",[e._v("@babel/preset-env")]),e._v(" 现在注入语法特性所需的 polyfills：使用 "),r("code",[e._v("for-of")]),e._v("时的迭代器，解构、扩展运算符和 "),r("code",[e._v("yield")]),e._v(" 委托；使用动态 "),r("code",[e._v("import")]),e._v(" 时的 promises，异步函数和generators，等。")]),e._v(" "),r("p",[e._v("Babel 7.4 支持注入提案 polyfills。默认，"),r("code",[e._v("@babel/preset-env")]),e._v(" 不会注入他们，但是你能够通过 "),r("code",[e._v("proposals")]),e._v(" 标志设置："),r("code",[e._v("corejs: { version: 3, proposals: true }")]),e._v("。")]),e._v(" "),r("h3",{attrs:{id:"babel-runtime"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#babel-runtime","aria-hidden":"true"}},[e._v("#")]),e._v(" @babel/runtime")]),e._v(" "),r("p",[e._v("当使用 "),r("code",[e._v("core-js@3")]),e._v(" 时， "),r("a",{attrs:{href:"https://babeljs.io/docs/en/next/babel-plugin-transform-runtime#corejs",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("@babel/transform-runtime")]),r("OutboundLink")],1),e._v(" 现在通过 "),r("code",[e._v("core-js-pure")]),e._v("（"),r("code",[e._v("core-js")]),e._v("的一个版本，不会污染全局变量） 注入 polyfills。")]),e._v(" "),r("p",[e._v("通过将"),r("code",[e._v("@babel/transform-runtime")]),e._v("设置 "),r("code",[e._v("corejs: 3")]),e._v(" 选项和创建"),r("code",[e._v("@babel/runtime-corejs3")]),e._v("包，已经将 "),r("code",[e._v("core-js@3")]),e._v(" 和 "),r("code",[e._v("@babel/runtime")]),e._v(" 集成在一起。但是这将带来什么好处呢？")]),e._v(" "),r("p",[r("code",[e._v("@babel/runtime")]),e._v(" 的一个受欢迎的 issue 是它不支持实例方法。从 "),r("code",[e._v("@babel/runtime-corejs3")]),e._v("开始，这个问题已经解决。例如，")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[e._v("array"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("includes")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("something"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("将被编译为")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" _includesInstanceProperty "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"@babel/runtime-corejs3/core-js-stable/instance/includes"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("_includesInstanceProperty")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("array"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("call")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("array"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" something"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("另一个值得关注的变化是支持 ECMAScript 提案。默认情况下的，"),r("code",[e._v("@babel/plugin-transform-runtime")]),e._v(" 不会为提案注入 polyfills 并使用不包含提案的入口。但是正如你在 "),r("code",[e._v("@babel/preset-env")]),e._v(" 中做的那样，你可以设置 "),r("code",[e._v("proposals")]),e._v(" 标志去开启："),r("code",[e._v("corejs: { version: 3, proposals: true }")]),e._v("。")]),e._v(" "),r("p",[e._v("没有 "),r("code",[e._v("proposals")]),e._v(" 标志，")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("new")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Set")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nstring"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("matchAll")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token regex"}},[e._v("/something/g")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("将被编译为：")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" _Set "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"@babel/runtime-corejs/core-js-stable/set"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("new")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("_set")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nstring"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("matchAll")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token regex"}},[e._v("/something/g")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("当设置 "),r("code",[e._v("proposals")]),e._v(" 后，将变为：")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" _Set "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"@babel/runtime-corejs3/core-js/set"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" _matchAllInstanceProperty "),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"@babel/runtime-corejs/core-js/instance/match-all"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("new")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("_Set")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("_matchAllInstanceProperty")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("string"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[e._v("call")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("string"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token regex"}},[e._v("/something/g")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("有些老的问题已经被修复了。例如，下面这种流行的模式在 "),r("code",[e._v("@babel/runtime-corejs2")]),e._v(" 不工作，但是在 "),r("code",[e._v("@babel/runtime-corejs3")]),e._v(" 被支持。")]),e._v(" "),r("div",{staticClass:"language-js extra-class"},[r("pre",{pre:!0,attrs:{class:"language-js"}},[r("code",[e._v("myArrayLikeObject"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("Symbol"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("tierator"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Array")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("prototype"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("Symbol"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("iterator"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),r("p",[e._v("尽管 "),r("code",[e._v("@babel/runtime")]),e._v(" 早期版本不支持实例方法，但是使用一些自定义的帮助函数能够支持迭代（"),r("code",[e._v("[Symbol.iterator]()")]),e._v(" 和他的presence）。之前不支持提取 "),r("code",[e._v("[Symbol.iterator]")]),e._v(" 方法，但是现在支持了。")]),e._v(" "),r("p",[e._v("作为意外收获，"),r("code",[e._v("@babel/runtime")]),e._v(" 现在支持IE8-（是IE8及以上的意思吗……），但是有些限制，例如，IE8-不支持访问器、模块转换应该用松散的方式，"),r("code",[e._v("regenerator-runtime")]),e._v("（内部使用ES5+实现）需要通过这个插件转译。")]),e._v(" "),r("h2",{attrs:{id:"畅享未来"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#畅享未来","aria-hidden":"true"}},[e._v("#")]),e._v(" 畅享未来")]),e._v(" "),r("p",[e._v("做了许多工作，但是 "),r("code",[e._v("core-js")]),e._v(" 距离完美还很远。这个库和工具将来应该如何改进？语言的变化将会如何影响它？")]),e._v(" "),r("h3",{attrs:{id:"老的引擎支持"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#老的引擎支持","aria-hidden":"true"}},[e._v("#")]),e._v(" 老的引擎支持")]),e._v(" "),r("p",[e._v("现在，"),r("code",[e._v("core-js")]),e._v(" 试图去支持所有可能的引擎或者我们能够测试到的平台：甚至是IE8-，或者例如，早期版本的 Firefox。虽然它对某些用户有用，但是仅有一小部分使用 "),r("code",[e._v("core-js")]),e._v(" 的开发者需要它。对于大多数用户，它将引起像包体积过大或者执行缓慢的问题。")]),e._v(" "),r("p",[e._v("主要的问题源自于支持 ES3 引擎（首先是IE8-）：多数现代 ES 特性是基于 ES5，这些功能在老版本浏览器中均不可用。")]),e._v(" "),r("p",[e._v("最大的缺失特性是属性描述符：当它缺失时，一些功能不能 polyfill，因为他们要么是访问器（像 "),r("code",[e._v("RegExp.prototype.flags")]),e._v(" 或 "),r("code",[e._v("URL")]),e._v(" 属性的 setters）要么就是基于访问器（像 typed array polyfill）。为了解决这个不足，我们需要使用不同的解决方法（例如，保持 "),r("code",[e._v("Set.prototype.size")]),e._v(" 更新）。维护这些解决方法有时很痛苦，移除他们将极大的简化许多 polyfills。")]),e._v(" "),r("p",[e._v("然而，描述符仅仅是问题的一部分。ES5 标准库包含了很多其他特性，他们被认为是现代 JavaScript 的基础："),r("code",[e._v("Object.create")]),e._v("，"),r("code",[e._v("Object.getPrototypeOf")]),e._v("，"),r("code",[e._v("Array.prototype.forEach")]),e._v("，"),r("code",[e._v("Function.prototype.bind")]),e._v("，等等。和多数现代特性不同，"),r("code",[e._v("core-js")]),e._v(" 内部依赖他们并且"),r("a",{attrs:{href:"https://github.com/babel/babel/pull/7646#discussion_r179333093",target:"_blank",rel:"noopener noreferrer"}},[e._v("为了实现一个简单的现代函数，"),r("code",[e._v("core-js")]),e._v(' 需要加载其中一些"建筑模块"的实现'),r("OutboundLink")],1),e._v("。对于想要创建一个最大限度小的构建包和仅仅想要引入部分 "),r("code",[e._v("core-js")]),e._v(" 的用户来说，这是个问题。")])])}),[],!1,null,null,null);t.default=a.exports}}]);